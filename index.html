<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Clean Code</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css" id="theme">
		<link rel="stylesheet" href="css/override.css">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section data-background-color="#83b35b">
					<h1 class="orange">Code Clean</h1>
					<h3 class="white">ConCrédito 2015</h3>
					<p>

					</p>
				</section>

				<section>
					<h2 class="orange">Temas de la charla</h2>
					<ul>
						<li>Clean Code</li>
						<li>Nombres Significativos</li>
						<li>Funciones</li>
						<li>Comentarios</li>
					</ul>
				</section>

				<section>
					<section>
						<h1 class="orange">
							Clean Code
						</h1>
					</section>

					<section>
	 					<h2>Siempre habrá código...</h2>
					</section>
				</section>



				<!-- Example of nested vertical slides -->
				<section>
					<section>
						<p>
							¿Alguna vez has sido obstaculizado por mal código?

							<h2>
								<label for="text" class="fragment orange">¿Entonces por qué escribimos mal código?</label>
							</h2>
						</p>
							<span class="fragment">Estabas en un apuro, existía una urgencia.</span><br>
							<span class="fragment">Tal vez estabas fastidiado</span><br>
							<span class="fragment">El backlog de pendientes era grande y corto tiempo</span>
					</section>

					<section data-transition="slide" data-background="#8b0000" data-background-transition="zoom">
						<h2>¡Todos lo hemos hecho!</h2>

						<p class="fragment justify">
							Todos hemos visto nuestro código desastroso funcionar y pensamos que eso es mejor
							que nada y que después lo haremos mejor.
						</p>
					</section>

					<section>
						<h1 class="orange">Ley de Leblanc</h1>

						<h2 class="fragment">
							Después equivale a nunca
						</h2>
					</section>
				</section>

				<section>


					<section>
						<h2 class="green">El costo de tener un desastre</h2>
							<p class="justify">
								Si has trabajado como developer por algunos años seguramente te has visto relentizado
								significativamente por el mal código de alguien en al menos una ocasión.
							</p>

							<p class="justify">
								La productividad del equipo es inversamente proporcional al desastre en el proyecto.
							</p>

					</section>


					<section>
						<p class="justify">
							En periodos de alrededor dos años, equipos que se movían muy rápido al inicio del
							proyecto se pueden encontrar moviéndose a paso muy lento.
						</p>


						<p class="justify">
							La mayóría de los cambios que hacen al
							código afecta a dos o tres partes diferentes del código.
						</p>

					</section>

					<section data-transition="slide" data-background="#8b0000" data-background-transition="zoom">
						<img src="img/orochi.jpg" alt="">

						Eventualmente terminamos con un proyecto así
					</section>

					<section>
						<p class="justify">
							Se decide realizar un equipo con los mejores programadores para que rehagan el sistema, pero sin abandonar el viejo, por lo que se convierte en una carrera.

						</p>
						<p class="justify">
							El sistema nuevo debe alcanzar al sistema viejo y aparte agregar todos los cambios al sistema y no se reemplazará el sistema hasta que el nuevo haga todo lo que el viejo.
						</p>
					</section>


					<section>
						<p class="justify">
							Es nuestro trabajo defender el código. La mayoría de los administradores de proyectos quieren la verdad, aun cuando no actúen así.
						</p>

						<p class="fragment justify">
							La mayoría de los administradores quieren buen código, aun cuando defiendan el cronograma y requerimientos con pasión; pero ese es su trabajo.
						</p>

						<p class="fragment justify">
							Es tu trabajo defender el código con la misma pasión.
						</p>
					</section>

					<section data-transition="slide" data-background="#007c00" data-background-transition="zoom">
						<h1 class="em2">Analogía</h1>
						<p class="justify">
							Qué tal si tú fueras un doctor y tuvieras un paciente que
							pidiera que no te lavaras las manos en preparación para una cirugía porque toma demasiado tiempo.
							Claramente el paciente es el jefe, pero aun así como doctor deberías de rechazar completamente
							a ceder. Sería improfesional (incluso criminal) obedecer al paciente.
						</p>

						<p class="fragment justify">
							Tambien es improfesional para los programadores doblegarse al deseo de los administradores que no
							entienden los riesgos de hacer desastres.
						</p>

					</section>



					<section>
						<p class="justify">
							El mal código tienta al desastre a crecer. Cuando alguien modifica mal código, tienden a hacerlo peor.
						</p>
					</section>

					<section>
						<h2 class="green">El edificio de la ventana rota</h2>
					</section>

					<section>
						<p>
							El código limpio es como realizar una pintura.
						</p>
					</section>

					<section>
						<p class="justify">
							"El código limpio es simple y directo. El código limpio se lee como una prosa bien escrita" - Grady Booch
						</p>

						<p class="fragment justify">
							"El código limpio siempre se ve como si fuera escrito por alguien a quien le importa" - Michael Feathers
						</p>
					</section>



					<section>
						<h2 class="green">Regla del Boy Scout</h2>

						<p class="fragment ">
							Deja el campamento más limpio de lo que lo encontraste.
						</p>

						<p class="fragment justify">
							Los cambios de mejora no necesitan ser grandes, limpia o refactoriza una función, cambia el nombre de una variable, etc.
						</p>
					</section>




				</section>


				<section>
					<section>
						<h2 class="green">Nombres significativos</h2>
					</section>


					<section>
						<h3 class="em">Usa nombres que revelen la intención</h3>
						<p class="fragment justify">
							Escoger buenos nombres toma tiempo, pero ahorra más de lo que toma.
						</p>



						<section class="fragment" data-markdown>
```javascript
var d; //elapsed time in days
```
						</section>

						<span class="fragment">
							<p class="justify">
								En cambio
							</p>

							<section data-markdown>

```javascript
var elapsedTimeInDays;
var daysSinceCreation;
var fileAgeInDays;
```
							</section>

						</span>

						<p class="fragment justify">
							"Una diferencia entre un programador muy inteligente y un programador profesional
							es que el profesional entiende que la claridad es la reina" //<span class="em">Evita mapeo mental</span>.
						</p>

					</section>
				</section>

				<section>
					<section>
						<h2 class="green">Haz distinciones significativas</h2>
						<section data-markdown>

```java
package com.aliax.web.modelo.atencionalcliente;

public class CatalogosClienteFacade {

	public static Clientes clientesLeer(String pkopcion, ...) {}

	public static Clientes clientesTraer(String nombre, ...) {}

	public static InfoSucursal getInfoSucursal(Integer pksucursal ...) {}

	public static void grabaModelosDeVehiculos(ModelosDeVehiculos modelos ...) {}

}

```
						</section>
					</section>
				</section>

				<section>
					<section>
						<h3 class="em">Nombres de métodos</h3>
						<p class="justify">
							Deben de ser asertivos y revelar la intención
							de lo que realizan. Por ejemplo observemos el siguiente método:
						</p>

					</section>

				</section>

				<section>
							<section data-markdown>

```php

function getDispositivosActivos() {

    GLOBAL $dbh;

    $query = 'SELECT pkcolocadora FROM
    		apiConCredito.dispositivos
          	WHERE sesionActiva = 1 AND baneado = 0
          	group by pkcolocadora';

    $result = execQ( $query, $dbh, 'mysqli' );
    return $result['fetch_assoc'];

}

```


```php

function getDistribuidorasConDispositivosActivos() {
   /*
		////
		////
   */
}

```
						</section>
				</section>

				<section>

					<section>
						<h2 class="em">Escoge una palabra por concepto</h2>
						<section data-markdown>
```java
public class CatalogosClienteFacade {

	public static Clientes clientesLeer( String pkopcion, ...) {}
	public static Clientes clientesTraer( String nombre, ...) {}
	public static Integer retirosParcialesGrabar() {}
	public static void grabaModelosDeVehiculos(ModelosDeVehiculos modelos) {}
}

```

```php
class ColocadorasIVR {

	static function findByNombreUsuario( $nombreUsuario) {}

    static function findByReferencia( $referencia, $campos = [] ) {}

    static function findByReferenciaNip( $referencia, $nip, $campos = [] ) {}

    static function findByReferenciaMD5( $referencia, $campos = [] ) {}

    static function findByReferenciaMD5AndFechaNacimiento( $numeroReferencia, $fechaNacimiento ) {}

    public function save() {}

```

						</section>
					</section>
				</section>

				<section>
					<section id="fragments">
						<h2 class="em">Añade contexto significativo</h2>
						<p class="fragment justify">
							Imagina que tienes variables llamadas calle, ciudad, estado y codigoPostal.
							Viéndolas juntas es claro que forman una dirección ¿Pero qué si ves a la variable
							estado en alguna parte del código siendo usada sola en un método?

							<br><br>
							Serviría poner como prefijo direccionEstado.

						</p>

					</section>

					<section>
						<h3 class="em">Aunque sería mejor crear una clase Direccion </h3>
						<section data-markdown>

```php
class Direccion {
	private $calle;
	private $ciudad;
	private $estado;
	private $codigoPostal;

	function getDireccion() {
		return $calle.' '.$codigoPostal.' '.$ciudad.' '.$estado;
	}

}
```

						</section>
					</section>
				</section>

				<section>
					<section>
						<h3 class="em">No añadas contexto gratuito</h3>
						<ul>
							<li class="fragment">Creas una app GasStationDeluxe</li>
							<li class="fragment">Una clase GSDAccountAddress para manejar correos</li>
							<li class="fragment">Despúes necesitas manejar correos de clientes</li>
							<li class="fragment">¿Utilizarías GSDAccountAddress?</li>
						</ul>
					</section>
				</section>


				<section>
					<h1 class="em">Funciones</h1>
				</section>

				<section>
					<h3 class="green">Small!</h3>
					<p class="fragment justify">
						La primera regla de las funciones es que deben de ser pequeñas.
					</p>

					<p class="fragment justify">
						La segunda regla es que deberían de ser más pequeñas que eso.
					</p>

				</section>

				<section>
					<p class="justify green">Las funciones deben de realizar una sola cosa, hacerla bien y solo ellas hacerla.</p>
					<img src="img/one.png" alt="">
				</section>

				<section>
					<h3 class="em">Express\Model\ValedineroClientes.php</h3>
					<section data-markdown>
```php
public function getConsentimientoSeguro($pkcliente, $perfil) {
    $query = "SELECT pkconsentimiento, pkModuloOpcional,
    		IFNULL(PadeceCancerSida,'NO') AS PadeceCancerSida
            FROM valedinero_clientesconsentimientosseguro
            WHERE pkcliente=:pkcliente AND status='A'
            ORDER BY pkconsentimiento DESC LIMIT 1";

    $result = DB::connection($this->connection)->select($query,
    				['pkcliente' => $this->pkcliente]);
    $result = (sizeof($result)> 0 ) ? $result[0] : $result;

    if( sizeof($result) <= 0 ) {
        $perfil['tieneConsentimiento'] = 'NO';
    } else {
        $perfil['tieneConsentimiento'] = 'SI';
        $perfil['pkconsentimiento'] = $result['pkconsentimiento'];
        $perfil['pkModuloOpcional'] = $result['pkModuloOpcional'];
        $perfil['padeceCancerSida'] = $result['PadeceCancerSida'];
    }

    return $perfil;
}
```
					</section>
				</section>

				<section>
					<h3 class="em">Express\Model\ValedineroClientes.php</h3>
					<section data-markdown>
```php
public function tieneConsentimientoSeguro( $pkCliente ) {
	/* código imaginario */
	return true | false;
}


public function getConsentimientoSeguro( $pkcliente ) {
    /* código imaginario */
    return $consentimiento;
}
```
					</section>
				</section>

				<section id="transitions">
					<h3 class="em justify">
						Algunos tips para identificar este problema:
					</h3>

					<ul>
						<li>La función maneja varios niveles de abstracción(Combina manejo de archivos con
							cálculos o reglas de negocio).</li>
						<li>Si puedes ​extraer​ otra función a partir de la actual.</li>
						<li>Si una función hace solo una cosa, no puedes dividir el código en
							secciones.</li>
					</ul>
				</section>

				<section id="themes">
					<h2 class="green">The Stepdown Rule</h2>
					<p class="justify">
						El código debería de leerse como si fuera una pequeña historia bien ordenada.
					</p>

					<section data-markdown>
```java
public void includeSetupAndTearDownPages() throws Exception {
	this.includeSetupPages();
	this.includePageContent();
	this.incluceTearDownPages();
	this.updatePageContent();
}

```
					</section>


				</section>

				<section>
					<section>
						<h3 class="green">Switch statements</h3>
						<section data-markdown>
```java
public Salario calcularSalario(Empleado e) {
	throws TipoDeEmpleadoInvalido {
		switch( e.tipo ) {
			case COMISIONADO:
				return calcularComisionado(e);
			case POR_HORA:
				return calcularPorHora(e);
			default:
				throw new TipoDeEmpleadoInvalido();
		}
	}
}
```
						</section>

						<ul>
							<li class="fragment">Viola el principio de una sola responsabilidad</li>
							<li class="fragment">Viola el principio Open-Close</li>
						</ul>

					</section>
				</section>

				<section>
					<section>
						<h2 class="em">Argumentos de funciones</h2>
						<p class="justify">
							El número ideal de argumentos para una función es cero (<span class="green">niladic</span>). Después uno (<span class="green">monadic</span>), seguido de ahí muy cerca (<span class="green">dyadic</span>). Tres argumentos (<span class="green">tryadic</span>) deberían de ser evitados cuando sea posible. Más de tres argumentos (<span class="orange">polyadic</span>) requieren una justificación muy especial y de todas maneras no deberían de ser usados.
						</p>
					</section>

					<section>
						<p class="justify">
							El uso de muchos argumentos es incluso más tedioso para las tareas de testing. Imaginen la dificultad de programar todos los casos de prueba para asegurar que todas las variaciones de combinaciones de argumentos funcionan adecuadamente.
						</p>
					</section>

					<section>
						<h3 class="em">Argumentos bandera</h3>
						<p class="justify">
							Los argumentos bandera son horribles. Pasar un boolean a una función es una muy mala práctica. Es una fuerte declaración de que el código hace más de una cosa.

						</p>
					</section>

					<section>
						<h3 class="em">Objetos como argumentos</h3>
						<p class="justify">
							Cuando una función recibe más de dos o tres argumentos, es muy probable que esos argumentos puedan ser envueltos en una clase.
						</p>
					</section>

					<section data-markdown>
```php
private function getInformacionVehiculo( $params ) {

    $arrVehiculo['categoria'] =
    	(!empty($params['categoria']) ? $params['categoria'] : '');

    $arrVehiculo['serie'] =
    	(!empty($params['serie']) ? $params['serie'] : '');

    $arrVehiculo['motor'] =
    	(!empty($params['motor']) ? $params['motor'] : '');

    $arrVehiculo['numPlaca'] =
    	(!empty($params['numPlaca']) ? $params['numPlaca'] : '');

    return $arrVehiculo;
}
```
					</section>
				</section>

				<section>
					<section>
						<h2 class="green">Sin efectos secundarios</h2>
						<section data-markdown>
```php
function verificarPasswordExpress($usuario, $password) {
	if( $usuario->getPassword() == $password ) {
		$this->iniciarSesion($usuario);
		return true;
	} else {
		return false;
	}
}

```
						</section>
					</section>

					<section>
						<h3 class="green">Command Query Separation</h3>
						<p class="justify">
							Las funciones deberían de hacer algo o responder algo, pero no ambas.
						</p>

						<p class="justify">
							Una función debería de cambiar el estado de un objeto, o retornar información acerca de él, pero no ambas cosas.
						</p>


						<section data-markdown>
```java
//Consideramos la función
public boolean set( String atributo, String valor);

//y en su uso:
if( set("usuario", "root") ) ...
```
						</section>

						<p class="justify">
							Imagina eso desde el punto de vista de un lector: ¿Qué diantres hace la función?
						</p>

					</section>
				</section>

				<section>
					<section>
						<p class="justify green">
							La solución sería hacer una separación command-query:
						</p>

						<section data-markdown>
```java
if( atributoExiste("usuario") ) {
	setAtributo("usuario", "root")
}
```
						</section>

					</section>
				</section>


				<section>
					<section>
						<p class="em">Prefiere las excepciones a retornar códigos de error:</p>
						<section data-markdown="">
```java
if( this.eliminar() == E_OK) {
	if( this.eliminarReferencias() == E_OK) {
			logger.log('Cliente eliminado satisfactoriamente');
	} else {
		logger.log("eliminación fallida");
	}
} else {
	logger.log("eliminación fallida");
	return E_ERROR;
}
```
Prefiere:
```java
try {
	this.eliminar();
	this.eliminarReferencias();
} catch( Exception e ) {
	logger.log('eliminación fallida');
}
```
						</section>
					</section>
				</section>

				<section>
					<section>
						<p class="justify em">Extrae los bloques try/catch:</p>

						<section data-markdown>
```java

public void eliminar() {
	try {
		this.eliminarClienteConReferencias();
	} catch() {
		logger.log("Eliminación fallida");
	}
}

public function elimnarClienteConReferencias() throws Exception {
	this.eliminar();
	this.eliminarReferencias();
}

```
						</section>

						<p class="fragment justify">Recuerda que las funciones deben de realizar una sola cosa, y el manejo de errores es una cosa.</p>
					</section>
				</section>



				<section data-transition="slide" data-background="#000033" data-background-transition="zoom">
					<p class="orange">Observen</p>
					<section data-markdown="">
```java
public class InformacionSeguroVidaDTO {

    Integer pkColocadora, pkCliente;

    // INFORMACION QUE ELIGE EL USUAIOR DEL SEGURO DE VIDA
    String folioValeDigital, padeceCancerSida;
    Integer pkModuloOpcional = 0;

    // informacion de los beneficiarios
    String nombreBeneficiario1;
    String primerApellidoBeneficiario1;
    String segundoApellidoBeneficiario1;
    String nombreBeneficiario2;
    String primerApellidoBeneficiario2;
    String segundoApellidoBeneficiario2;
}
```
					</section>

					<p class="orange">Android/InformacionSeguroVidaDTO.java</p>
				</section>


				<section>
					<section>
						<h1 class="green">DRY</h1>
						<h3 class="fragment green">Don't Repeat Yourself</h3>
						<h3 class="fragment green">Usa abstracciones</h3>
					</section>
				</section>

				<section>
					<section>
						<h1 class="green">Comentarios</h1>
						<p class="em">
							"No comentes mal código - Reescríbelo.", Brian W. Kerninghan
						</p>
					</section>

					<section data-transition="slide" data-background="#8b0000" data-background-transition="zoom">

						<p>
							El uso adecuado de los comentarios es para compensar nuestro fallo en expresarnos en el código.
						</p>

					</section>

					<section>

						<p>
							Explica lo que haces con el mismo con el código
						</p>
						<section data-markdown>
```java
if(detalleFor.getPkCuentaContable().intValue() ==
			detalleIndividual.getPkCuentaContable().intValue()
   &&
   		detalleFor.getPkSucursal().intValue() ==
   		detalleIndividual.getPkSucursal().intValue() ) {}
```
						</section>

						<span class="fragment"><p class="em">Una mejor opción sería:</p>

							<section data-markdown="">
```php
if( validaCuentaContableSucursal(detalleFor, detalleIndividual)) {
	// Keep calm and code
}

public boolean validaCuentaContableSucursal(Tipo detalleFor, Tipo detalleIndividual) {
	return detalleFor.getPkCuentaContable().intValue() ==
			detalleIndividual.getPkCuentaContable().intValue()
   		&&
   		detalleFor.getPkSucursal().intValue() ==
   		detalleIndividual.getPkSucursal().intValue();
}

```
							</section>
						</span>
					</section>
				</section>

				<section>
					<section>
						<p class="green">Hay comentarios que son buenos como los legales</p>

						<section data-markdown="">

```java
//Copyright (C) 2003,2004,2005 by Object Mentor, Inc.
//All rights reserved
//Released under the terms of the GNU General Public License
//version 2 or later
```
informativos
```java
//format matched kk:mm:ss EEE, MMM dd, yyyy
Pattern timeMatcher =
	Pattern.compile("\\d*:\\d*:\\d* \\w*, \\w* \\d*, \\d*");
```

o TODO

```javascript
//TODO: Aplicar refactorizacion
var x = function(alphabet) {
	for(var i = 0; i < alphabet.length; i++ )
		console.log(alphabet[i]);
}
```

						</section>

					</section>
				</section>

				<section>
					<section>
						<h3 class="em">Evita los comentarios reduntantes</h3>
						<section data-markdown>
```java
class FTP {
	/**
	* Disconnects from the FTP server.
	*/
	public synchronized void disconnect() throws IOException {
	  try {
	      sendLine("QUIT");
	  } finally {
	      socket = null;
	  }
	}
}
```
```java
public class RegistrarseFinalActivity extends ActionBarActivity {
		...
		...
		...
		// show alert
		alertDialog.show();
}
```

						</section>
					</section>
				</section>


<section>
	<h2 class="orange">Fin</h2>

	<h2 class="orange">Aunque queda mucho por hacer</h2>
</section>

<section>
	<h2 class="orange">¿Dónde obtener más información?</h2>

	<h3 class="em">Clean Code</h3>
	<h3 class="em">PHP Objects, patterns and practice</h3>
	<h3 class="em">The Pragmatic Programmer</h3>
</section>


			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
